---
title: "Authorization and Authentication"
description: "Learn how to authenticate and authorize requests to the Safe Locker API, including obtaining and managing API keys securely."
mode: "wide"
---

To ensure secure access to the Safe Locker API, each request must include a valid API key in the request header. This guide walks you through generating an API key, authenticating API calls, and managing key expiration.

***

## Overview

The Safe Locker API uses **API keys** as the primary authentication mechanism. Each API request requires an `Authorization` header containing a valid API key. API keys can be generated in the Safe Locker dashboard and are used to sign all requests.

***

<AccordionGroup>

<Accordion title="Step 1: Obtain an API Key">

To begin using the Safe Locker API, you need to generate an API key from the dashboard.

<Steps>
1. **Log in to the Dashboard**  
   Visit [https://safe-staging.fezdelivery.co/](https://safe-staging.fezdelivery.co/) and log in with your credentials.
2. **Navigate to the API Keys Section**  
   In the left-side menu, select **API Keys** to access the API key management page.
3. **Generate a New API Key**  
   Click the **Generate API Key** button at the top right.
4. **Provide API Details**  
   - **API Name**: Enter a descriptive name (maximum 25 characters).
   - **API Description** (optional): Enter a description (maximum 60 characters).
   - **Expiration Date**: Set an expiration date in the future.
5. **Copy and Store Your API Key**  
   Once generated, **copy** the API key and store it securely, as it will not be displayed again.
</Steps>

> **Note**: Treat your API key like a passwordâ€”keep it confidential and secure.

</Accordion>

<Accordion title="Step 2: Generate Access Token Using API Key, Username, and Password">

To authenticate, each API request needs an access token. This token is generated by sending your username and password in the body of the request, while including your API key in the header.

**Token Request Endpoint**: `POST /auth/token`

<CodeBlock title="Request Example" language="http">
```http
POST /auth/token
Host: api.safe-staging.fezdelivery.co
Content-Type: application/json
Authorization: Bearer your-api-key

{
  "username": "your-username",
  "password": "your-password"
}
```
</CodeBlock>

- **Authorization Header**: Include your API key as a `Bearer` token in the `Authorization` header.
- **username** and **password**: These should be the same as your login credentials for the Safe Locker dashboard.

> **Tip**: Store the access token securely, as it will be required for all subsequent API requests.

**Response Example**:

<CodeBlock title="Response Example" language="json">
```json
{
  "access_token": "your-access-token",
  "token_type": "Bearer",
  "expires_in": 3600
}
```
</CodeBlock>

<Tabs>
<Tab title="Explanation of Response Fields">
- **access_token**: This token must be included in the `Authorization` header for subsequent requests.
- **token_type**: Typically `Bearer`, indicating the type of token.
- **expires_in**: The token's lifespan in seconds (e.g., 3600 seconds = 1 hour).
</Tab>
</Tabs>

<Callout type="info" title="Token Expiration">
Access tokens are temporary and expire after the specified duration. Generate a new token when it expires to maintain uninterrupted access.
</Callout>

</Accordion>

<Accordion title="Step 3: Using the Access Token in API Requests">

Once you have an access token, you can include it in the `Authorization` header for all Safe Locker API requests.

<CodeBlock title="Example Request with Access Token" language="http">
```http
GET /api/lockers/available
Host: api.safe-staging.fezdelivery.co
Authorization: Bearer your-access-token
```
</CodeBlock>

The `Authorization` header should include the token in the format: `Bearer your-access-token`.

</Accordion>

<Accordion title="Step 4: Handling Expired Tokens">

Since access tokens are temporary, they will expire after a specified period. When an access token expires, generate a new token using the same request format as in **Step 2**.

> **Note**: There is no refresh token mechanism; simply repeat the request to get a new access token when the current one expires.

</Accordion>

</AccordionGroup>

***

## API Key Security Best Practices

To maintain the security and integrity of your Safe Locker API access, follow these best practices when managing API keys.

<Callout title="Why is API Key Security Important?" type="info">
API keys are like passwords that grant access to your Safe Locker data. If your key is compromised, unauthorized users may be able to access, modify, or delete your data. Protect your API keys as you would any other sensitive credentials.
</Callout>

### 1. Store API Keys Securely
- **Environment Variables**: Store API keys in environment variables rather than hardcoding them in your codebase. This is particularly important for applications that are publicly accessible.
- **Secure Vaults**: Use secure storage solutions like AWS Secrets Manager, Azure Key Vault, or HashiCorp Vault to manage and protect sensitive keys.
- **Encryption**: If storing API keys in a database or file, ensure they are encrypted at rest.

### 2. Avoid Exposing API Keys in Public Repositories
- **Never Hardcode in Source Code**: Avoid placing API keys directly in source code files. Hardcoding keys makes it easy for others to discover them, especially in version-controlled repositories.
- **Git Ignore Sensitive Files**: Use `.gitignore` to exclude files containing sensitive information (e.g., `.env` files) from being pushed to public repositories.
- **Scan for Exposed Keys**: Use tools like [GitGuardian](https://www.gitguardian.com/) or [TruffleHog](https://github.com/trufflesecurity/trufflehog) to scan repositories for any accidental key exposure.

### 3. Rotate API Keys Regularly
- **Periodic Key Rotation**: Rotate API keys periodically (e.g., every 90 days) to reduce the risk associated with long-term exposure.
- **Revoke Compromised Keys Immediately**: If you suspect an API key has been compromised, revoke it immediately from the Safe Locker dashboard and generate a new one.

### 4. Limit Access and Permissions
- **Restrict by IP Address**: If possible, restrict API key usage to specific IP addresses, allowing only trusted servers to access the API.
- **Use Least Privilege Principle**: Only grant the minimal permissions necessary for each API key. Avoid using a high-privilege key if a read-only key would suffice.
- **Monitor API Usage**: Regularly review API key activity logs to detect any unusual or unauthorized usage patterns.

### 5. Secure Development and Deployment Practices
- **Avoid Embedding Keys in Front-End Code**: Front-end applications (like JavaScript-based web apps) can expose API keys to end users. For public APIs, consider using a backend server to securely handle API requests.
- **Secure Build and Deployment Pipelines**: Ensure that CI/CD pipelines and build systems that access API keys are secure and follow best practices for handling secrets.
- **Use Environment-Specific Keys**: For environments like development, staging, and production, use separate API keys to minimize impact in case of a compromise in one environment.

### 6. Implement Monitoring and Alerts
- **Set Up Usage Alerts**: Configure alerts to notify you of unusual API activity, such as spikes in usage or access from unexpected locations.
- **Monitor Rate Limits**: Keep an eye on rate limits to detect and prevent abuse or misconfigurations that could result in excessive API requests.

<Callout title="Pro Tip" type="tip">
Consider automating API key rotation as part of your security policy. Many platforms provide APIs for key management, making it possible to programmatically rotate and update keys on a regular schedule.
</Callout>

By following these best practices, you can minimize the risk of unauthorized access and ensure that your API keys remain secure.


## Common Errors and Troubleshooting

<AccordionGroup>

<Accordion title="Common Errors">
<Tabs>
<Tab title="401 - Unauthorized">
Unauthorized â€“ Invalid or missing token. Ensure the `Authorization` header includes a valid token.
</Tab>
<Tab title="403 - Forbidden">
Forbidden â€“ Insufficient permissions. Verify your API key permissions or contact support.
</Tab>
<Tab title="429 - Too Many Requests">
Too Many Requests â€“ Rate limit exceeded. Reduce request frequency or contact support for quota details.
</Tab>
</Tabs>
</Accordion>

</AccordionGroup>

***

## Example Workflow Summary

<CardGroup>
<Card title="1. Generate API Key" icon="ðŸ”‘">
Create and store your API key from the dashboard.
</Card>

<Card title="2. Obtain Access Token" icon="ðŸ”“">
Request an access token using your API key, username, and password.
</Card>

<Card title="3. Make API Requests" icon="ðŸŒ">
Include the access token in the `Authorization` header for each API call.
</Card>

<Card title="4. Refresh Token" icon="ðŸ”„">
Request a new token once the current one expires.
</Card>
</CardGroup>
